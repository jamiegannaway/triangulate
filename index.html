<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>triangulate.dev — workforce data platform</title>
  <meta name="description" content="triangulate.dev — comprehensive workforce intelligence platform. Understand your workforce needs from any starting point." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0a0b0d;
      --bg-gradient-1: rgba(99, 102, 241, 0.08);
      --bg-gradient-2: rgba(139, 92, 246, 0.06);
      --panel: #0f1014;
      --panel2: #14161c;
      --text: #f0f0f5;
      --text-secondary: #a0a0b0;
      --muted: #70708a;
      --muted2: #50506a;
      --border: rgba(255,255,255,.06);
      --border2: rgba(255,255,255,.10);
      --border-hover: rgba(255,255,255,.18);
      --accent: #818cf8;
      --accent2: #a78bfa;
      --accent-glow: rgba(129, 140, 248, 0.25);
      --shadow: 0 4px 24px rgba(0,0,0,.4);
      --radius: 16px;
      --radius-sm: 10px;
      --success: #10b981;
      --warning: #f59e0b;
      --coral: #f87171;
    }
    [data-theme="light"] {
      --bg: #f8f9fc;
      --bg-gradient-1: rgba(99, 102, 241, 0.06);
      --bg-gradient-2: rgba(139, 92, 246, 0.04);
      --panel: #ffffff;
      --panel2: #f0f1f5;
      --text: #1a1a2e;
      --text-secondary: #4a4a6a;
      --muted: #6a6a8a;
      --muted2: #8a8aa0;
      --border: rgba(0,0,0,.08);
      --border2: rgba(0,0,0,.12);
      --border-hover: rgba(99, 102, 241, 0.3);
      --accent: #6366f1;
      --accent2: #8b5cf6;
      --accent-glow: rgba(99, 102, 241, 0.2);
      --shadow: 0 4px 24px rgba(0,0,0,.08);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(ellipse 80% 50% at 20% -10%, var(--bg-gradient-1), transparent),
        radial-gradient(ellipse 60% 40% at 80% 10%, var(--bg-gradient-2), transparent), var(--bg);
      color: var(--text);
      min-height: 100vh;
      transition: background 0.3s ease, color 0.3s ease;
    }
    .wrap { max-width: 1200px; margin: 0 auto; padding: 24px 24px 80px; }
    header { display: flex; align-items: center; justify-content: space-between; gap: 16px; padding: 16px 0 32px; flex-wrap: wrap; }
    .brand { display: flex; align-items: center; gap: 14px; }
    .logo { width: 42px; height: 42px; border-radius: 12px; background: linear-gradient(135deg, var(--accent), var(--accent2)); box-shadow: var(--shadow), 0 0 20px var(--accent-glow); position: relative; overflow: hidden; }
    .logo::before { content: ""; position: absolute; inset: 0; background: linear-gradient(135deg, transparent 40%, rgba(255,255,255,0.3) 50%, transparent 60%); animation: shimmer 3s infinite; }
    @keyframes shimmer { 0% { transform: translateX(-100%) rotate(45deg); } 100% { transform: translateX(100%) rotate(45deg); } }
    .brand h1 { font-size: 18px; font-weight: 600; letter-spacing: -0.3px; }
    .header-actions { display: flex; align-items: center; gap: 12px; }
    .theme-toggle { width: 44px; height: 44px; border-radius: 12px; border: 1px solid var(--border); background: var(--panel); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; }
    .theme-toggle:hover { border-color: var(--border-hover); background: var(--panel2); }
    .theme-toggle svg { width: 20px; height: 20px; color: var(--text-secondary); transition: color 0.2s ease; }
    .theme-toggle:hover svg { color: var(--accent); }
    .sun-icon { display: none; } .moon-icon { display: block; }
    [data-theme="light"] .sun-icon { display: block; } [data-theme="light"] .moon-icon { display: none; }
    .btn-ghost { padding: 10px 16px; border: 1px solid var(--border); background: transparent; color: var(--text-secondary); font-family: inherit; font-size: 13px; font-weight: 500; border-radius: var(--radius-sm); cursor: pointer; transition: all 0.2s; }
    .btn-ghost:hover { border-color: var(--border-hover); color: var(--text); background: var(--panel); }
    .btn-primary { display: inline-flex; align-items: center; gap: 10px; padding: 12px 20px; border-radius: 12px; border: 1px solid var(--accent); background: linear-gradient(135deg, rgba(129, 140, 248, 0.15), rgba(167, 139, 250, 0.1)); color: var(--text); font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.25s ease; font-family: inherit; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 24px var(--accent-glow); }
    .btn-primary svg { width: 18px; height: 18px; }
    .card { border: 1px solid var(--border); background: var(--panel); border-radius: var(--radius); box-shadow: var(--shadow); }
    .badge { display: inline-flex; align-items: center; gap: 8px; padding: 8px 14px; border: 1px solid var(--border); background: rgba(129, 140, 248, 0.1); border-radius: 999px; color: var(--accent); font-size: 12px; font-weight: 500; }
    .badge::before { content: ""; width: 6px; height: 6px; border-radius: 50%; background: var(--accent); animation: pulse 2s infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
    .screen { display: none; animation: fadeIn 0.4s ease; }
    .screen.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }

    /* ENTRY SCREEN */
    .entry-container { max-width: 800px; margin: 0 auto; }
    .entry-header { text-align: center; margin-bottom: 40px; }
    .entry-header .badge { margin-bottom: 20px; }
    .title { font-size: 40px; line-height: 1.1; font-weight: 700; letter-spacing: -1.5px; margin-bottom: 16px; background: linear-gradient(135deg, var(--text) 0%, var(--text-secondary) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .subtitle { color: var(--text-secondary); font-size: 16px; line-height: 1.6; max-width: 560px; margin: 0 auto 24px; }
    
    /* Data Sources Button */
    .data-sources-link {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 20px;
      border: 1px solid rgba(16, 185, 129, 0.4);
      background: rgba(16, 185, 129, 0.08);
      border-radius: 999px;
      color: var(--success);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.25s ease;
      text-decoration: none;
      margin-bottom: 8px;
    }
    .data-sources-link:hover {
      border-color: rgba(16, 185, 129, 0.6);
      background: rgba(16, 185, 129, 0.12);
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(16, 185, 129, 0.2);
    }
    .data-sources-link svg {
      width: 18px;
      height: 18px;
    }
    .data-sources-link .verified-icon {
      width: 18px;
      height: 18px;
      background: var(--success);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .data-sources-link .verified-icon svg {
      width: 12px;
      height: 12px;
      color: white;
    }
    
    .helper-box { background: rgba(129, 140, 248, 0.06); border: 1px solid rgba(129, 140, 248, 0.15); border-radius: var(--radius-sm); padding: 20px 24px; margin-bottom: 32px; }
    .helper-title { font-size: 14px; font-weight: 600; color: var(--accent); margin-bottom: 10px; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .helper-title svg { width: 18px; height: 18px; }
    .helper-text { font-size: 14px; color: var(--text-secondary); line-height: 1.6; text-align: center; }
    .helper-paths { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 14px; justify-content: center; }
    .helper-path { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; background: var(--panel); border: 1px solid var(--border); border-radius: 999px; font-size: 12px; color: var(--text-secondary); }
    .helper-path-icon { width: 16px; height: 16px; border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600; }
    .helper-path-icon.t { background: rgba(59, 130, 246, 0.2); color: #60a5fa; }
    .helper-path-icon.s { background: rgba(167, 139, 250, 0.2); color: var(--accent2); }
    .helper-path-icon.j { background: rgba(16, 185, 129, 0.2); color: var(--success); }
    .helper-path-icon.o { background: rgba(248, 113, 113, 0.2); color: var(--coral); }
    .helper-path-icon.p { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
    .entry-inputs-container { display: flex; flex-direction: column; gap: 24px; margin-bottom: 32px; }
    .entry-card { background: var(--panel); border: 2px solid var(--border); border-radius: var(--radius); padding: 28px; transition: all 0.3s ease; }
    .entry-card:focus-within { border-color: var(--accent); box-shadow: 0 0 0 4px var(--accent-glow), var(--shadow); }
    .entry-card-header { display: flex; align-items: center; gap: 16px; margin-bottom: 18px; }
    .entry-card-num { width: 44px; height: 44px; border-radius: 12px; background: linear-gradient(135deg, var(--accent), var(--accent2)); color: white; font-size: 18px; font-weight: 700; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 4px 12px var(--accent-glow); }
    .entry-card-label { font-size: 18px; font-weight: 600; color: var(--text); }
    .entry-card-label .optional { font-size: 13px; font-weight: 400; color: var(--muted); margin-left: 8px; }
    .entry-input { width: 100%; padding: 18px 22px; border: 1px solid var(--border); border-radius: var(--radius-sm); background: var(--panel2); color: var(--text); font-family: inherit; font-size: 16px; outline: none; transition: all 0.2s; }
    .entry-input::placeholder { color: var(--muted2); }
    .entry-input:focus { border-color: var(--accent); background: var(--panel); }
    .entry-input.textarea { min-height: 120px; resize: vertical; }
    .entry-actions { display: flex; justify-content: center; margin-bottom: 40px; }
    .btn-analyze { padding: 20px 48px; border: none; border-radius: var(--radius); background: linear-gradient(135deg, var(--accent), var(--accent2)); color: white; font-family: inherit; font-size: 18px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 12px; box-shadow: 0 8px 32px var(--accent-glow); }
    .btn-analyze:hover { transform: translateY(-3px); box-shadow: 0 12px 40px var(--accent-glow); }
    .btn-analyze svg { width: 22px; height: 22px; }
    .examples-section { margin-bottom: 48px; text-align: center; }
    .examples-label { font-size: 12px; color: var(--muted); text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 14px; }
    .examples-grid { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
    .example-chip { padding: 10px 18px; border: 1px solid var(--border); border-radius: 999px; background: transparent; color: var(--text-secondary); font-family: inherit; font-size: 13px; cursor: pointer; transition: all 0.2s; }
    .example-chip:hover { border-color: var(--accent); color: var(--text); background: rgba(129, 140, 248, 0.08); }

    /* Info Cards Bottom */
    .info-cards-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; padding-top: 40px; border-top: 1px solid var(--border); }
    @media (max-width: 900px) { .info-cards-row { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 500px) { .info-cards-row { grid-template-columns: 1fr; } }
    .info-card { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); padding: 24px; text-align: center; transition: all 0.2s ease; }
    .info-card:hover { border-color: var(--border-hover); transform: translateY(-2px); }
    .info-card-icon { width: 48px; height: 48px; margin: 0 auto 16px; border-radius: 12px; display: flex; align-items: center; justify-content: center; }
    .info-card-icon svg { width: 24px; height: 24px; }
    .info-card-icon.purple { background: rgba(129, 140, 248, 0.15); color: var(--accent); }
    .info-card-icon.green { background: rgba(16, 185, 129, 0.15); color: var(--success); }
    .info-card-icon.orange { background: rgba(245, 158, 11, 0.15); color: var(--warning); }
    .info-card-icon.coral { background: rgba(248, 113, 113, 0.15); color: var(--coral); }
    .info-card-title { font-size: 15px; font-weight: 600; color: var(--text); margin-bottom: 8px; }
    .info-card-desc { font-size: 13px; color: var(--muted); line-height: 1.5; }

    /* INTERPRETING */
    .interpreting-container { max-width: 640px; margin: 0 auto; padding: 40px 20px; }
    .interpreting-header { display: flex; align-items: center; gap: 14px; margin-bottom: 32px; }
    .spinner { width: 24px; height: 24px; border: 2px solid var(--border); border-top-color: var(--accent); border-radius: 50%; animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .interpreting-title { font-size: 20px; font-weight: 600; }
    .detected-card { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); padding: 24px; margin-bottom: 20px; }
    .detected-label { font-family: 'JetBrains Mono', monospace; font-size: 11px; text-transform: uppercase; letter-spacing: 1.5px; color: var(--muted); margin-bottom: 16px; }
    .detected-items { display: flex; flex-direction: column; gap: 12px; }
    .detected-item { display: flex; align-items: center; gap: 14px; padding: 12px 16px; background: var(--panel2); border-radius: var(--radius-sm); }
    .detected-icon { width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; }
    .detected-icon.title { background: rgba(59, 130, 246, 0.15); color: #60a5fa; }
    .detected-icon.jtbd { background: rgba(16, 185, 129, 0.15); color: var(--success); }
    .detected-icon.skill { background: rgba(167, 139, 250, 0.15); color: var(--accent2); }
    .detected-icon.outcome { background: rgba(248, 113, 113, 0.15); color: var(--coral); }
    .detected-icon.problem { background: rgba(245, 158, 11, 0.15); color: var(--warning); }
    .detected-text { flex: 1; }
    .detected-type { font-size: 11px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 2px; }
    .detected-value { font-size: 14px; color: var(--text); }
    .clarification-card { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); padding: 24px; margin-bottom: 20px; }
    .clarification-question { font-size: 15px; color: var(--text); margin-bottom: 16px; line-height: 1.5; }
    .clarification-options { display: flex; flex-wrap: wrap; gap: 10px; }
    .clarification-option { flex: 1; min-width: 120px; padding: 14px 16px; border: 1px solid var(--border); border-radius: var(--radius-sm); background: transparent; color: var(--text-secondary); font-family: inherit; font-size: 13px; cursor: pointer; transition: all 0.2s; text-align: center; }
    .clarification-option:hover { border-color: var(--accent); color: var(--text); background: rgba(129, 140, 248, 0.08); }
    .clarification-option.selected { border-color: var(--accent); background: var(--accent); color: white; }

    /* WORKSPACE */
    .workspace-header { margin-bottom: 24px; }
    .workspace-breadcrumb { font-family: 'JetBrains Mono', monospace; font-size: 11px; text-transform: uppercase; letter-spacing: 1.5px; color: var(--muted); margin-bottom: 8px; }
    .workspace-title-row { display: flex; align-items: flex-start; justify-content: space-between; gap: 20px; flex-wrap: wrap; }
    .workspace-title { font-size: 28px; font-weight: 700; letter-spacing: -0.5px; margin-bottom: 8px; }
    .workspace-subtitle { color: var(--text-secondary); font-size: 14px; }
    .workspace-actions { display: flex; gap: 10px; flex-wrap: wrap; }
    .btn-scenario, .btn-mcp, .btn-deep-dive { padding: 10px 18px; font-family: inherit; font-size: 13px; font-weight: 500; border-radius: var(--radius-sm); cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 8px; }
    .btn-scenario svg, .btn-mcp svg, .btn-deep-dive svg { width: 16px; height: 16px; }
    .btn-scenario { border: 1px solid rgba(245, 158, 11, 0.4); background: rgba(245, 158, 11, 0.1); color: var(--warning); }
    .btn-scenario:hover { background: rgba(245, 158, 11, 0.15); border-color: rgba(245, 158, 11, 0.6); }
    .btn-mcp { border: 1px solid rgba(16, 185, 129, 0.4); background: rgba(16, 185, 129, 0.1); color: var(--success); }
    .btn-mcp:hover { background: rgba(16, 185, 129, 0.15); border-color: rgba(16, 185, 129, 0.6); }
    .btn-deep-dive { border: 1px solid var(--accent); background: rgba(129, 140, 248, 0.1); color: var(--accent); }
    .btn-deep-dive:hover { background: rgba(129, 140, 248, 0.15); }
    .panels-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
    @media (max-width: 1000px) { .panels-grid { grid-template-columns: 1fr; } }
    .panel { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; }
    .panel.full-width { grid-column: 1 / -1; }
    .panel-header { padding: 18px 22px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px; }
    .panel-title { font-size: 14px; font-weight: 600; }
    .panel-toggle { display: flex; gap: 4px; padding: 4px; background: var(--panel2); border-radius: 8px; }
    .panel-toggle-btn { padding: 6px 12px; border: none; background: transparent; color: var(--muted); font-family: inherit; font-size: 11px; border-radius: 6px; cursor: pointer; transition: all 0.2s; }
    .panel-toggle-btn.active { background: var(--bg); color: var(--text); }
    .panel-body { padding: 22px; }

    /* Role & Seniority */
    .role-seniority-container { display: grid; grid-template-columns: 1fr 1fr; gap: 32px; }
    @media (max-width: 600px) { .role-seniority-container { grid-template-columns: 1fr; } }
    .track-title { font-size: 11px; text-transform: uppercase; letter-spacing: 1.5px; color: var(--muted); margin-bottom: 16px; text-align: center; }
    .ladder-vertical { display: flex; flex-direction: column; align-items: center; position: relative; }
    .ladder-line { position: absolute; left: 50%; top: 20px; bottom: 20px; width: 2px; background: var(--border); transform: translateX(-50%); z-index: 0; }
    .ladder-item { display: flex; align-items: center; gap: 12px; padding: 10px 14px; position: relative; z-index: 1; width: 100%; max-width: 180px; background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius-sm); margin-bottom: 8px; transition: all 0.2s; }
    .ladder-item:last-child { margin-bottom: 0; }
    .ladder-item.active { border-color: var(--accent); background: rgba(129, 140, 248, 0.08); }
    .ladder-item.above, .ladder-item.below { opacity: 0.5; transform: scale(0.92); }
    .ladder-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--border); flex-shrink: 0; transition: all 0.3s; }
    .ladder-item.active .ladder-dot { background: var(--accent); box-shadow: 0 0 10px var(--accent-glow); }
    .ladder-content { flex: 1; }
    .ladder-label { font-size: 12px; color: var(--text); font-weight: 500; }
    .ladder-sub { font-size: 9px; color: var(--muted); margin-top: 2px; }
    .ladder-item.active .ladder-label { color: var(--accent); font-weight: 600; }

    /* Spider */
    .spider-container { display: flex; justify-content: center; align-items: center; padding: 20px; }
    .spider-svg { max-width: 100%; height: auto; }
    .spider-legend { display: flex; flex-wrap: wrap; justify-content: center; gap: 16px; margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--border); }
    .spider-legend-item { display: flex; align-items: center; gap: 8px; font-size: 12px; color: var(--text-secondary); }
    .spider-legend-dot { width: 10px; height: 10px; border-radius: 50%; }
    .spider-legend-dot.core { background: var(--accent); }
    .spider-legend-dot.supporting { background: var(--success); }

    /* Cost Panel */
    .cost-panel { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; }
    .cost-panel-header { padding: 20px 24px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 16px; }
    .cost-panel-title { font-size: 16px; font-weight: 600; }
    .cost-panel-subtitle { font-size: 12px; color: var(--muted); margin-top: 4px; }
    .cost-panel-body { padding: 24px; }
    .region-selector { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 24px; padding-bottom: 20px; border-bottom: 1px solid var(--border); }
    .region-selector-label { font-size: 12px; color: var(--muted); width: 100%; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; }
    .region-chip { padding: 8px 16px; border: 2px solid var(--border); border-radius: 999px; background: transparent; color: var(--text-secondary); font-family: inherit; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 8px; }
    .region-chip:hover { border-color: var(--border-hover); color: var(--text); }
    .region-chip.active { border-color: var(--region-color, var(--accent)); background: var(--region-bg, rgba(129, 140, 248, 0.1)); color: var(--text); }
    .region-chip .region-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--region-color, var(--muted)); }
    .region-chip.active .region-dot { box-shadow: 0 0 8px var(--region-color, var(--accent)); }
    .region-chip[data-region="uk"] { --region-color: #818cf8; --region-bg: rgba(129, 140, 248, 0.1); }
    .region-chip[data-region="germany"] { --region-color: #f59e0b; --region-bg: rgba(245, 158, 11, 0.1); }
    .region-chip[data-region="poland"] { --region-color: #10b981; --region-bg: rgba(16, 185, 129, 0.1); }
    .region-chip[data-region="india"] { --region-color: #06b6d4; --region-bg: rgba(6, 182, 212, 0.1); }
    .region-chip[data-region="philippines"] { --region-color: #ec4899; --region-bg: rgba(236, 72, 153, 0.1); }
    .region-chip[data-region="usa"] { --region-color: #f87171; --region-bg: rgba(248, 113, 113, 0.1); }
    .candlestick-chart-container { position: relative; width: 100%; min-height: 400px; }
    .candlestick-chart { width: 100%; height: 400px; }
    .chart-legend-row { display: flex; justify-content: center; gap: 32px; margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border); }
    .chart-legend-item { display: flex; align-items: center; gap: 10px; font-size: 13px; color: var(--text-secondary); }
    .chart-legend-candle { display: flex; flex-direction: column; align-items: center; gap: 2px; }
    .chart-legend-wick { width: 2px; height: 8px; background: var(--text-secondary); }
    .chart-legend-body { width: 16px; height: 20px; border-radius: 3px; }
    .chart-legend-body.range { background: var(--accent); opacity: 0.6; }
    .chart-tooltip { position: absolute; background: var(--panel2); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 14px 18px; font-size: 12px; box-shadow: var(--shadow); pointer-events: none; z-index: 100; display: none; min-width: 200px; }
    .chart-tooltip.visible { display: block; }
    .chart-tooltip-title { font-weight: 600; font-size: 14px; margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1px solid var(--border); }
    .chart-tooltip-row { display: flex; justify-content: space-between; padding: 4px 0; }
    .chart-tooltip-label { color: var(--muted); }
    .chart-tooltip-value { font-weight: 500; color: var(--text); }
    .chart-tooltip-region { margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border); }
    .chart-tooltip-region-row { display: flex; align-items: center; gap: 8px; padding: 4px 0; }
    .chart-tooltip-region-dot { width: 8px; height: 8px; border-radius: 50%; }
    .chart-sources { margin-top: 20px; display: flex; gap: 24px; flex-wrap: wrap; justify-content: center; }
    .chart-source { font-size: 11px; color: var(--muted); display: flex; align-items: center; gap: 6px; }
    .chart-source svg { width: 14px; height: 14px; }

    /* AI */
    .ai-task-list { display: flex; flex-direction: column; gap: 10px; }
    .ai-task-item { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; background: var(--panel2); border-radius: var(--radius-sm); }
    .ai-task-name { font-size: 13px; color: var(--text); }
    .ai-task-badge { padding: 5px 10px; border-radius: 6px; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
    .ai-task-badge.automatable { background: rgba(16, 185, 129, 0.15); color: var(--success); }
    .ai-task-badge.augmentable { background: rgba(245, 158, 11, 0.15); color: var(--warning); }
    .ai-task-badge.human-led { background: rgba(248, 113, 113, 0.15); color: var(--coral); }
    .ai-signal { margin-top: 16px; padding: 14px; background: var(--panel2); border-radius: var(--radius-sm); border-left: 3px solid var(--accent); }
    .ai-signal-label { font-size: 10px; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px; }
    .ai-signal-text { font-size: 13px; color: var(--text-secondary); font-style: italic; }

    /* Deep Dive */
    .deep-dive-container { max-width: 700px; margin: 0 auto; padding: 40px 20px; }
    .deep-dive-header { margin-bottom: 32px; }
    .deep-dive-title { font-size: 24px; font-weight: 700; margin-bottom: 8px; }
    .deep-dive-subtitle { color: var(--text-secondary); font-size: 14px; }
    .deep-dive-progress { display: flex; align-items: center; gap: 8px; margin-bottom: 32px; }
    .progress-step { flex: 1; height: 4px; background: var(--border); border-radius: 2px; transition: all 0.3s; }
    .progress-step.active { background: var(--accent); }
    .progress-step.completed { background: var(--success); }
    .deep-dive-question { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); padding: 28px; margin-bottom: 24px; }
    .question-number { font-family: 'JetBrains Mono', monospace; font-size: 11px; color: var(--accent); margin-bottom: 12px; }
    .question-text { font-size: 18px; font-weight: 600; margin-bottom: 20px; line-height: 1.4; }
    .question-options { display: flex; flex-direction: column; gap: 10px; }
    .question-option { padding: 16px 20px; border: 1px solid var(--border); border-radius: var(--radius-sm); background: transparent; color: var(--text-secondary); font-family: inherit; font-size: 14px; cursor: pointer; transition: all 0.2s; text-align: left; }
    .question-option:hover { border-color: var(--accent); color: var(--text); background: rgba(129, 140, 248, 0.05); }
    .question-option.selected { border-color: var(--accent); background: rgba(129, 140, 248, 0.1); color: var(--text); }
    .deep-dive-nav { display: flex; justify-content: space-between; gap: 16px; }
    .btn-back { padding: 12px 24px; border: 1px solid var(--border); background: transparent; color: var(--text-secondary); font-family: inherit; font-size: 14px; border-radius: var(--radius-sm); cursor: pointer; transition: all 0.2s; }
    .btn-back:hover { border-color: var(--border-hover); color: var(--text); }
    .btn-next { padding: 12px 24px; border: none; background: var(--accent); color: white; font-family: inherit; font-size: 14px; font-weight: 500; border-radius: var(--radius-sm); cursor: pointer; transition: all 0.2s; }
    .btn-next:hover { filter: brightness(1.1); }
    .btn-next:disabled { opacity: 0.5; cursor: not-allowed; }

    /* Modal */
    .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(4px); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
    .modal-overlay.active { display: flex; }
    .modal { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); padding: 32px; max-width: 560px; width: 100%; box-shadow: var(--shadow); animation: modal-in 0.3s ease; position: relative; max-height: 90vh; overflow-y: auto; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.95) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-close { position: absolute; top: 16px; right: 16px; width: 36px; height: 36px; border: none; background: transparent; color: var(--muted); cursor: pointer; border-radius: 8px; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; }
    .modal-close:hover { background: var(--panel2); color: var(--text); }
    .modal-icon { width: 56px; height: 56px; border-radius: 14px; background: rgba(16, 185, 129, 0.1); display: flex; align-items: center; justify-content: center; margin-bottom: 20px; }
    .modal-icon svg { width: 28px; height: 28px; color: var(--success); }
    .modal h2 { font-size: 22px; font-weight: 600; margin-bottom: 8px; }
    .modal-subtitle { color: var(--text-secondary); font-size: 14px; line-height: 1.6; margin-bottom: 28px; }
    .upload-section { margin-bottom: 16px; }
    .upload-label { font-size: 13px; font-weight: 500; color: var(--text); margin-bottom: 8px; display: block; }
    .upload-area { border: 2px dashed var(--border); border-radius: var(--radius-sm); padding: 20px; text-align: center; cursor: pointer; transition: all 0.2s; }
    .upload-area:hover { border-color: var(--accent); background: rgba(129, 140, 248, 0.05); }
    .upload-area-icon { width: 36px; height: 36px; margin: 0 auto 10px; background: var(--panel2); border-radius: 8px; display: flex; align-items: center; justify-content: center; }
    .upload-area-icon svg { width: 18px; height: 18px; color: var(--muted); }
    .upload-area-text { font-size: 12px; color: var(--text-secondary); }
    .upload-area-hint { font-size: 10px; color: var(--muted); margin-top: 4px; }
    .coming-soon-badge { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); border-radius: 999px; font-size: 11px; color: var(--warning); font-weight: 500; margin-top: 20px; }
    footer { margin-top: 48px; padding: 24px 0; border-top: 1px solid var(--border); display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 16px; font-size: 13px; color: var(--muted); }
    footer a { color: var(--text-secondary); transition: color 0.2s ease; text-decoration: none; }
    footer a:hover { color: var(--accent); }
    .footer-links { display: flex; gap: 16px; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand"><div class="logo"></div><h1>triangulate.dev</h1></div>
      <div class="header-actions">
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
          <svg class="moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
        </button>
        <button class="btn-ghost" onclick="resetToEntry()">New Query</button>
        <button class="btn-primary" onclick="openMCPModal()"><span>Add MCP</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg></button>
      </div>
    </header>

    <!-- ENTRY SCREEN -->
    <section id="entryScreen" class="screen active">
      <div class="entry-container">
        <div class="entry-header">
          <div class="badge">Workforce Intelligence Platform</div>
          <h2 class="title">Understand your workforce needs from any starting point</h2>
          <p class="subtitle">Describe a role, skill, outcome, problem, or job you need completed. We interpret your needs and deliver structured workforce intelligence.</p>
          
          <!-- DATA SOURCES VERIFICATION BUTTON -->
          <a href="data-sources.html" class="data-sources-link">
            <span class="verified-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
            </span>
            <span>Verified against 100+ data sources and repositories</span>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
          </a>
        </div>
        <div class="helper-box">
          <div class="helper-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>Work starts from different beginnings</div>
          <div class="helper-text">People think about work differently. Hiring managers think in job titles. Technologists think in skills. Executives think in outcomes. Finance thinks in costs. We normalize all of them into one canonical model.</div>
          <div class="helper-paths">
            <span class="helper-path"><span class="helper-path-icon t">T</span> Title-led</span>
            <span class="helper-path"><span class="helper-path-icon s">S</span> Skill-led</span>
            <span class="helper-path"><span class="helper-path-icon j">J</span> Job-to-be-done</span>
            <span class="helper-path"><span class="helper-path-icon o">O</span> Outcome-led</span>
            <span class="helper-path"><span class="helper-path-icon p">P</span> Problem-led</span>
          </div>
        </div>
        <div class="entry-inputs-container">
          <div class="entry-card">
            <div class="entry-card-header"><div class="entry-card-num">1</div><div class="entry-card-label">What are you trying to get done?</div></div>
            <input type="text" class="entry-input" id="inputTask" placeholder="e.g., I need a project manager for a CRM migration" autocomplete="off"/>
          </div>
          <div class="entry-card">
            <div class="entry-card-header"><div class="entry-card-num">2</div><div class="entry-card-label">What problem are you trying to solve? <span class="optional">(optional)</span></div></div>
            <textarea class="entry-input textarea" id="inputProblem" placeholder="e.g., Our CRM implementation is 6 months behind schedule and we're losing deals due to poor customer data quality..."></textarea>
          </div>
        </div>
        <div class="entry-actions">
          <button class="btn-analyze" onclick="submitQuery()"><span>Analyze Requirements</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg></button>
        </div>
        <div class="examples-section">
          <div class="examples-label">Try an example</div>
          <div class="examples-grid">
            <button class="example-chip" onclick="setExample('Senior data engineer for our ML pipeline', '')">Data Engineer</button>
            <button class="example-chip" onclick="setExample('I need to reduce our contractor spend by 20%', 'We have 200+ contractors across 15 vendors with no visibility into rates')">Cost Reduction</button>
            <button class="example-chip" onclick="setExample('Python, AWS, Kubernetes skills for DevOps', '')">Skills-based</button>
            <button class="example-chip" onclick="setExample('Transform our customer onboarding process', 'Customer churn at 90 days is 40% and NPS dropped from 45 to 28')">Transformation</button>
          </div>
        </div>
        <!-- INFO CARDS AT BOTTOM -->
        <div class="info-cards-row">
          <div class="info-card">
            <div class="info-card-icon purple"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
            <div class="info-card-title">Single mental model</div>
            <div class="info-card-desc">No tabs, no forced taxonomy. Enter naturally and we interpret your intent.</div>
          </div>
          <div class="info-card">
            <div class="info-card-icon green"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg></div>
            <div class="info-card-title">Canonical output</div>
            <div class="info-card-desc">Every input converges to one Work Summary: roles, skills, costs, and delivery options.</div>
          </div>
          <div class="info-card">
            <div class="info-card-icon orange"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg></div>
            <div class="info-card-title">Data-driven</div>
            <div class="info-card-desc">Powered by GICS classifications, ILO labour costs, OECD productivity data, and Deployed taxonomies.</div>
          </div>
          <div class="info-card">
            <div class="info-card-icon coral"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg></div>
            <div class="info-card-title">AI suitability</div>
            <div class="info-card-desc">Understand which tasks can be automated vs. augmented vs. human-led.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- INTERPRETING SCREEN -->
    <section id="interpretingScreen" class="screen">
      <div class="interpreting-container">
        <div class="interpreting-header"><div class="spinner"></div><span class="interpreting-title">Interpreting your request…</span></div>
        <div class="detected-card"><div class="detected-label">Detected Intent</div><div class="detected-items" id="detectedItems"></div></div>
        <div class="clarification-card"><div class="clarification-question" id="clarificationQuestion">One quick question to clarify scope:</div><div class="clarification-options" id="clarificationOptions"></div></div>
      </div>
    </section>

    <!-- WORKSPACE SCREEN -->
    <section id="workspaceScreen" class="screen">
      <div class="workspace-header">
        <div class="workspace-breadcrumb">Work Summary</div>
        <div class="workspace-title-row">
          <div><h2 class="workspace-title" id="workspaceTitle">Project delivery leadership for CRM migration</h2><p class="workspace-subtitle" id="workspaceSubtitle">Entry lens: Job title + Job-to-be-done</p></div>
          <div class="workspace-actions">
            <button class="btn-scenario"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><line x1="20" y1="8" x2="20" y2="14"/><line x1="23" y1="11" x2="17" y2="11"/></svg>Scenario builder</button>
            <button class="btn-mcp" onclick="openMCPModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg>Add MCP</button>
            <button class="btn-deep-dive" onclick="openDeepDive()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>Deep dive</button>
          </div>
        </div>
      </div>
      <div class="panel" style="margin-bottom: 20px;">
        <div class="panel-header"><span class="panel-title">Interpreted Need</span></div>
        <div class="panel-body"><p id="interpretedNeed" style="color: var(--text-secondary); line-height: 1.6;">You need a mid-to-senior level professional who can lead the delivery of a CRM migration project, coordinating cross-functional teams, managing timelines, and ensuring stakeholder alignment throughout the transformation.</p></div>
      </div>
      <div class="panels-grid">
        <div class="panel">
          <div class="panel-header"><span class="panel-title">Role & Seniority</span><div class="panel-toggle"><button class="panel-toggle-btn active">IC Track</button><button class="panel-toggle-btn">Mgmt Track</button></div></div>
          <div class="panel-body">
            <div class="role-seniority-container">
              <div><div class="track-title">Individual Contributor</div><div class="ladder-vertical"><div class="ladder-line"></div><div class="ladder-item above"><div class="ladder-dot"></div><div class="ladder-content"><div class="ladder-label">Staff PM</div><div class="ladder-sub">L6 / £120k+</div></div></div><div class="ladder-item active"><div class="ladder-dot"></div><div class="ladder-content"><div class="ladder-label">Senior PM</div><div class="ladder-sub">L5 / £85-110k</div></div></div><div class="ladder-item below"><div class="ladder-dot"></div><div class="ladder-content"><div class="ladder-label">PM</div><div class="ladder-sub">L4 / £65-85k</div></div></div><div class="ladder-item below"><div class="ladder-dot"></div><div class="ladder-content"><div class="ladder-label">Associate PM</div><div class="ladder-sub">L3 / £45-65k</div></div></div></div></div>
              <div><div class="track-title">Management</div><div class="ladder-vertical"><div class="ladder-line"></div><div class="ladder-item above"><div class="ladder-dot"></div><div class="ladder-content"><div class="ladder-label">Director</div><div class="ladder-sub">M4 / £140k+</div></div></div><div class="ladder-item above"><div class="ladder-dot"></div><div class="ladder-content"><div class="ladder-label">Sr Manager</div><div class="ladder-sub">M3 / £110-140k</div></div></div><div class="ladder-item"><div class="ladder-dot"></div><div class="ladder-content"><div class="ladder-label">Manager</div><div class="ladder-sub">M2 / £90-110k</div></div></div><div class="ladder-item below"><div class="ladder-dot"></div><div class="ladder-content"><div class="ladder-label">Team Lead</div><div class="ladder-sub">M1 / £75-90k</div></div></div></div></div>
            </div>
          </div>
        </div>
        <div class="panel">
          <div class="panel-header"><span class="panel-title">Skill Profile</span></div>
          <div class="panel-body">
            <div class="spider-container"><svg class="spider-svg" width="280" height="280" viewBox="0 0 280 280"><defs><linearGradient id="coreGrad" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#818cf8;stop-opacity:0.3"/><stop offset="100%" style="stop-color:#a78bfa;stop-opacity:0.1"/></linearGradient></defs><g transform="translate(140,140)"><polygon points="0,-100 86.6,-50 86.6,50 0,100 -86.6,50 -86.6,-50" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="1"/><polygon points="0,-75 65,-37.5 65,37.5 0,75 -65,37.5 -65,-37.5" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="1"/><polygon points="0,-50 43.3,-25 43.3,25 0,50 -43.3,25 -43.3,-25" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="1"/><polygon points="0,-25 21.7,-12.5 21.7,12.5 0,25 -21.7,12.5 -21.7,-12.5" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="1"/><line x1="0" y1="0" x2="0" y2="-100" stroke="rgba(255,255,255,0.06)"/><line x1="0" y1="0" x2="86.6" y2="-50" stroke="rgba(255,255,255,0.06)"/><line x1="0" y1="0" x2="86.6" y2="50" stroke="rgba(255,255,255,0.06)"/><line x1="0" y1="0" x2="0" y2="100" stroke="rgba(255,255,255,0.06)"/><line x1="0" y1="0" x2="-86.6" y2="50" stroke="rgba(255,255,255,0.06)"/><line x1="0" y1="0" x2="-86.6" y2="-50" stroke="rgba(255,255,255,0.06)"/><polygon points="0,-85 69.3,-35 60.6,40 0,70 -52,35 -52,-40" fill="url(#coreGrad)" stroke="#818cf8" stroke-width="2"/><circle cx="0" cy="-85" r="4" fill="#818cf8"/><circle cx="69.3" cy="-35" r="4" fill="#818cf8"/><circle cx="60.6" cy="40" r="4" fill="#818cf8"/><circle cx="0" cy="70" r="4" fill="#818cf8"/><circle cx="-52" cy="35" r="4" fill="#818cf8"/><circle cx="-52" cy="-40" r="4" fill="#818cf8"/><text y="-112" text-anchor="middle" fill="#a0a0b0" font-size="11">Planning</text><text x="100" y="-45" text-anchor="start" fill="#a0a0b0" font-size="11">Stakeholder Mgmt</text><text x="100" y="55" text-anchor="start" fill="#a0a0b0" font-size="11">Risk Mgmt</text><text y="125" text-anchor="middle" fill="#a0a0b0" font-size="11">Communication</text><text x="-100" y="55" text-anchor="end" fill="#a0a0b0" font-size="11">Agile/Scrum</text><text x="-100" y="-45" text-anchor="end" fill="#a0a0b0" font-size="11">CRM Systems</text></g></svg></div>
            <div class="spider-legend"><div class="spider-legend-item"><div class="spider-legend-dot core"></div>Core skills required</div><div class="spider-legend-item"><div class="spider-legend-dot supporting"></div>Supporting skills</div></div>
          </div>
        </div>
        <div class="panel full-width">
          <div class="cost-panel-header"><div><div class="cost-panel-title">Cost by Fulfilment Channel</div><div class="cost-panel-subtitle">Daily rate ranges (10th–90th percentile) by region</div></div></div>
          <div class="cost-panel-body">
            <div class="region-selector">
              <div class="region-selector-label">Compare regions</div>
              <button class="region-chip active" data-region="uk" onclick="toggleRegion(this)"><span class="region-dot"></span>United Kingdom</button>
              <button class="region-chip" data-region="germany" onclick="toggleRegion(this)"><span class="region-dot"></span>Germany</button>
              <button class="region-chip" data-region="poland" onclick="toggleRegion(this)"><span class="region-dot"></span>Poland</button>
              <button class="region-chip" data-region="india" onclick="toggleRegion(this)"><span class="region-dot"></span>India</button>
              <button class="region-chip" data-region="philippines" onclick="toggleRegion(this)"><span class="region-dot"></span>Philippines</button>
              <button class="region-chip" data-region="usa" onclick="toggleRegion(this)"><span class="region-dot"></span>United States</button>
            </div>
            <div class="candlestick-chart-container" id="chartContainer"><svg class="candlestick-chart" id="candlestickChart" viewBox="0 0 800 400"></svg><div class="chart-tooltip" id="chartTooltip"><div class="chart-tooltip-title" id="tooltipTitle">Permanent</div><div class="chart-tooltip-row"><span class="chart-tooltip-label">90th percentile</span><span class="chart-tooltip-value" id="tooltipHigh">£950</span></div><div class="chart-tooltip-row"><span class="chart-tooltip-label">Median</span><span class="chart-tooltip-value" id="tooltipMedian">£750</span></div><div class="chart-tooltip-row"><span class="chart-tooltip-label">10th percentile</span><span class="chart-tooltip-value" id="tooltipLow">£550</span></div><div class="chart-tooltip-region" id="tooltipRegions"></div></div></div>
            <div class="chart-legend-row"><div class="chart-legend-item"><div class="chart-legend-candle"><div class="chart-legend-wick"></div><div class="chart-legend-body range"></div><div class="chart-legend-wick"></div></div><span>Rate range (10th–90th percentile)</span></div><div class="chart-legend-item"><div style="width: 20px; height: 3px; background: var(--text); border-radius: 2px;"></div><span>Median rate</span></div></div>
            <div class="chart-sources"><span class="chart-source"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>Labour cost index (ILO)</span><span class="chart-source"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 20V10M12 20V4M6 20v-6"/></svg>Unit labour cost (OECD)</span><span class="chart-source"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5M2 12l10 5 10-5"/></svg>Deployed rate intelligence</span></div>
          </div>
        </div>
        <div class="panel full-width">
          <div class="panel-header"><span class="panel-title">Automation & AI Suitability</span></div>
          <div class="panel-body">
            <div class="ai-task-list" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 10px;"><div class="ai-task-item"><span class="ai-task-name">Status reporting</span><span class="ai-task-badge automatable">Automatable</span></div><div class="ai-task-item"><span class="ai-task-name">Plan tracking</span><span class="ai-task-badge augmentable">Augmentable</span></div><div class="ai-task-item"><span class="ai-task-name">Risk identification</span><span class="ai-task-badge augmentable">Augmentable</span></div><div class="ai-task-item"><span class="ai-task-name">Stakeholder negotiation</span><span class="ai-task-badge human-led">Human-led</span></div><div class="ai-task-item"><span class="ai-task-name">Team leadership</span><span class="ai-task-badge human-led">Human-led</span></div><div class="ai-task-item"><span class="ai-task-name">Decision making</span><span class="ai-task-badge human-led">Human-led</span></div></div>
            <div class="ai-signal"><div class="ai-signal-label">Overall Signal</div><div class="ai-signal-text">"AI likely augments junior delivery first, but senior judgment and stakeholder relationships remain human-led"</div></div>
          </div>
        </div>
      </div>
    </section>

    <!-- DEEP DIVE SCREEN -->
    <section id="deepDiveScreen" class="screen">
      <div class="deep-dive-container">
        <div class="deep-dive-header"><h2 class="deep-dive-title">Deep Dive: Refine Your Requirements</h2><p class="deep-dive-subtitle">Answer a few questions to get more precise specifications.</p></div>
        <div class="deep-dive-progress"><div class="progress-step active"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div><div class="progress-step"></div></div>
        <div class="deep-dive-question" id="deepDiveQuestion"></div>
        <div class="deep-dive-nav"><button class="btn-back" onclick="deepDiveBack()">Back</button><button class="btn-next" id="deepDiveNextBtn" onclick="deepDiveNext()" disabled>Continue</button></div>
      </div>
    </section>

    <footer><div>© <span id="year"></span> triangulate.dev — workforce data platform powered by Deployed</div><div class="footer-links"><a href="#" onclick="resetToEntry(); return false;">New Query</a><a href="data-sources.html">Data Sources</a><a href="#">Documentation</a><a href="#">API</a></div></footer>
  </div>

  <!-- MCP MODAL -->
  <div class="modal-overlay" id="mcpModal">
    <div class="modal">
      <button class="modal-close" onclick="closeMCPModal()"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg></button>
      <div class="modal-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg></div>
      <h2>Add Your Context (MCP)</h2>
      <p class="modal-subtitle">Connect your organization's data sources to get personalized workforce intelligence.</p>
      <div class="upload-section"><label class="upload-label">Business Case Register</label><div class="upload-area"><div class="upload-area-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg></div><div class="upload-area-text">Click to upload</div><div class="upload-area-hint">Excel, CSV, or PDF</div></div></div>
      <div class="upload-section"><label class="upload-label">Strategy Documents</label><div class="upload-area"><div class="upload-area-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div><div class="upload-area-text">Click to upload</div><div class="upload-area-hint">PDF, Word, PowerPoint</div></div></div>
      <div class="upload-section"><label class="upload-label">Project Database</label><div class="upload-area"><div class="upload-area-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg></div><div class="upload-area-text">Click to upload</div><div class="upload-area-hint">Excel, CSV, JSON</div></div></div>
      <div class="upload-section"><label class="upload-label">Preferred Supplier List</label><div class="upload-area"><div class="upload-area-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><line x1="20" y1="8" x2="20" y2="14"/><line x1="23" y1="11" x2="17" y2="11"/></svg></div><div class="upload-area-text">Click to upload</div><div class="upload-area-hint">Excel or CSV</div></div></div>
      <div class="upload-section"><label class="upload-label">Job Titles / Job Families</label><div class="upload-area"><div class="upload-area-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></div><div class="upload-area-text">Click to upload</div><div class="upload-area-hint">Excel or CSV</div></div></div>
      <div class="upload-section"><label class="upload-label">Supplier Categories</label><div class="upload-area"><div class="upload-area-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg></div><div class="upload-area-text">Click to upload</div><div class="upload-area-hint">Excel or CSV</div></div></div>
      <div style="text-align: center;"><div class="coming-soon-badge"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>Coming Soon</div></div>
    </div>
  </div>

  <script>
    function initTheme() { const s = localStorage.getItem('triangulate-theme'), p = window.matchMedia('(prefers-color-scheme: dark)').matches; document.documentElement.setAttribute('data-theme', s || (p ? 'dark' : 'light')); }
    document.getElementById('themeToggle').addEventListener('click', () => { const n = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'; document.documentElement.setAttribute('data-theme', n); localStorage.setItem('triangulate-theme', n); renderCandlestickChart(); });
    initTheme();

    let currentScreen = 'entry', deepDiveStep = 0, deepDiveAnswers = {}, activeRegions = ['uk'];
    const costData = { channels: ['Permanent', 'Contingent', 'Short Term Service'], regions: { uk: { name: 'United Kingdom', color: '#818cf8', data: { 'Permanent': { low: 450, median: 650, high: 900 }, 'Contingent': { low: 550, median: 800, high: 1100 }, 'Short Term Service': { low: 800, median: 1200, high: 1800 } } }, germany: { name: 'Germany', color: '#f59e0b', data: { 'Permanent': { low: 420, median: 620, high: 850 }, 'Contingent': { low: 520, median: 750, high: 1050 }, 'Short Term Service': { low: 750, median: 1100, high: 1650 } } }, poland: { name: 'Poland', color: '#10b981', data: { 'Permanent': { low: 180, median: 320, high: 480 }, 'Contingent': { low: 220, median: 400, high: 600 }, 'Short Term Service': { low: 350, median: 550, high: 850 } } }, india: { name: 'India', color: '#06b6d4', data: { 'Permanent': { low: 120, median: 220, high: 380 }, 'Contingent': { low: 150, median: 280, high: 450 }, 'Short Term Service': { low: 250, median: 420, high: 700 } } }, philippines: { name: 'Philippines', color: '#ec4899', data: { 'Permanent': { low: 80, median: 160, high: 280 }, 'Contingent': { low: 100, median: 200, high: 350 }, 'Short Term Service': { low: 180, median: 320, high: 550 } } }, usa: { name: 'United States', color: '#f87171', data: { 'Permanent': { low: 550, median: 850, high: 1200 }, 'Contingent': { low: 700, median: 1050, high: 1500 }, 'Short Term Service': { low: 1000, median: 1500, high: 2200 } } } } };

    function renderCandlestickChart() {
      const svg = document.getElementById('candlestickChart'), st = getComputedStyle(document.documentElement);
      const bc = st.getPropertyValue('--border').trim(), tc = st.getPropertyValue('--text-secondary').trim(), mc = st.getPropertyValue('--muted').trim();
      const w = 800, h = 400, p = { top: 40, right: 40, bottom: 80, left: 80 }, cw = w - p.left - p.right, ch = h - p.top - p.bottom;
      let mx = 0; activeRegions.forEach(rk => { costData.channels.forEach(cn => { if (costData.regions[rk].data[cn].high > mx) mx = costData.regions[rk].data[cn].high; }); }); mx = Math.ceil(mx / 500) * 500 + 200;
      const chW = cw / costData.channels.length, cdW = Math.min(60, chW / (activeRegions.length + 1)), sY = v => p.top + ch - (v / mx * ch);
      let s = '';
      for (let i = 0; i <= 5; i++) { const y = p.top + (ch / 5) * i, vl = Math.round(mx - (mx / 5) * i); s += '<line x1="'+p.left+'" y1="'+y+'" x2="'+(w-p.right)+'" y2="'+y+'" stroke="'+bc+'" stroke-dasharray="4,4"/>'; s += '<text x="'+(p.left-12)+'" y="'+(y+4)+'" text-anchor="end" fill="'+mc+'" font-size="11" font-family="Space Grotesk">£'+vl.toLocaleString()+'</text>'; }
      s += '<line x1="'+p.left+'" y1="'+p.top+'" x2="'+p.left+'" y2="'+(h-p.bottom)+'" stroke="'+bc+'"/><line x1="'+p.left+'" y1="'+(h-p.bottom)+'" x2="'+(w-p.right)+'" y2="'+(h-p.bottom)+'" stroke="'+bc+'"/>';
      costData.channels.forEach((cn, ci) => { const cx = p.left + chW * ci + chW / 2; s += '<text x="'+cx+'" y="'+(h-p.bottom+30)+'" text-anchor="middle" fill="'+tc+'" font-size="13" font-weight="500" font-family="Space Grotesk">'+cn+'</text>'; const tw = activeRegions.length * cdW + (activeRegions.length - 1) * 8, sx = cx - tw / 2; activeRegions.forEach((rk, ri) => { const r = costData.regions[rk], d = r.data[cn], x = sx + ri * (cdW + 8), yH = sY(d.high), yL = sY(d.low), yM = sY(d.median); s += '<line x1="'+(x+cdW/2)+'" y1="'+yH+'" x2="'+(x+cdW/2)+'" y2="'+yL+'" stroke="'+r.color+'" stroke-width="2"/>'; s += '<rect x="'+x+'" y="'+yH+'" width="'+cdW+'" height="'+(yL-yH)+'" fill="'+r.color+'" fill-opacity="0.3" stroke="'+r.color+'" stroke-width="2" rx="4" style="cursor:pointer" onmouseenter="showTooltip(event,\''+cn+'\',\''+rk+'\')" onmousemove="moveTooltip(event)" onmouseleave="hideTooltip()"/>'; s += '<line x1="'+x+'" y1="'+yM+'" x2="'+(x+cdW)+'" y2="'+yM+'" stroke="'+r.color+'" stroke-width="3" stroke-linecap="round"/>'; if (activeRegions.length <= 2) s += '<text x="'+(x+cdW/2)+'" y="'+(yM-8)+'" text-anchor="middle" fill="'+r.color+'" font-size="10" font-weight="600" font-family="JetBrains Mono">£'+d.median+'</text>'; }); });
      if (activeRegions.length > 1) { const ly = h - 15, liw = 120, tlw = activeRegions.length * liw, lsx = w / 2 - tlw / 2; activeRegions.forEach((rk, i) => { const r = costData.regions[rk], x = lsx + i * liw; s += '<circle cx="'+x+'" cy="'+ly+'" r="5" fill="'+r.color+'"/><text x="'+(x+12)+'" y="'+(ly+4)+'" fill="'+tc+'" font-size="11" font-family="Space Grotesk">'+r.name+'</text>'; }); }
      svg.innerHTML = s;
    }
    function showTooltip(e, ch, rk) { const t = document.getElementById('chartTooltip'), r = costData.regions[rk], d = r.data[ch]; document.getElementById('tooltipTitle').textContent = ch; document.getElementById('tooltipHigh').textContent = '£'+d.high.toLocaleString(); document.getElementById('tooltipMedian').textContent = '£'+d.median.toLocaleString(); document.getElementById('tooltipLow').textContent = '£'+d.low.toLocaleString(); let rh = ''; if (activeRegions.length > 1) activeRegions.forEach(k => { const rg = costData.regions[k], dt = rg.data[ch]; rh += '<div class="chart-tooltip-region-row"><span class="chart-tooltip-region-dot" style="background:'+rg.color+'"></span><span style="flex:1;color:var(--text-secondary)">'+rg.name+'</span><span style="font-weight:500">£'+dt.median.toLocaleString()+'</span></div>'; }); document.getElementById('tooltipRegions').innerHTML = rh; t.classList.add('visible'); moveTooltip(e); }
    function moveTooltip(e) { const t = document.getElementById('chartTooltip'), c = document.getElementById('chartContainer'), r = c.getBoundingClientRect(); let x = e.clientX - r.left + 15, y = e.clientY - r.top - 10; if (x + 220 > r.width) x = e.clientX - r.left - 220; if (y + 200 > r.height) y = r.height - 200; t.style.left = x + 'px'; t.style.top = y + 'px'; }
    function hideTooltip() { document.getElementById('chartTooltip').classList.remove('visible'); }
    function toggleRegion(btn) { const rg = btn.dataset.region, i = activeRegions.indexOf(rg); if (i > -1) { if (activeRegions.length > 1) { activeRegions.splice(i, 1); btn.classList.remove('active'); } } else { activeRegions.push(rg); btn.classList.add('active'); } renderCandlestickChart(); }

    const deepDiveQuestions = [{ id: 'scope', question: 'What is the primary scope of this role?', options: ['Coordinating delivery across teams', 'Owning end-to-end outcomes', 'Strategic oversight and governance', 'Hands-on execution and support'] }, { id: 'autonomy', question: 'What level of autonomy would this person have?', options: ['Works independently with minimal oversight', 'Regular check-ins with manager', 'Close collaboration with senior leadership', 'Part of a larger team structure'] }, { id: 'duration', question: 'What is the expected engagement duration?', options: ['Short-term (< 3 months)', 'Medium-term (3-6 months)', 'Long-term (6-12 months)', 'Ongoing / Permanent'] }, { id: 'budget', question: 'What is your approximate daily rate budget?', options: ['Under £400 / day', '£400 - £650 / day', '£650 - £900 / day', 'Over £900 / day', 'Flexible / Need guidance'] }, { id: 'channel', question: 'What is your preferred fulfilment channel?', options: ['Direct contractor', 'Through a staffing agency', 'Consulting firm / SOW-based', 'Internal hire', 'Open to recommendations'] }];
    const exampleInterpretations = { 'I need a project manager for a CRM migration': { intents: [{ type: 'title', icon: 'T', value: 'Project Manager' }, { type: 'jtbd', icon: 'J', value: 'CRM migration' }], clarification: { question: 'Is this role mainly about:', options: ['Coordinating delivery', 'Owning outcomes', 'Both'] }, workspace: { title: 'Project delivery leadership for CRM migration', subtitle: 'Entry lens: Job title + Job-to-be-done', need: 'You need a mid-to-senior level professional who can lead the delivery of a CRM migration project, coordinating cross-functional teams, managing timelines, and ensuring stakeholder alignment throughout the transformation.' } }, 'Senior data engineer for our ML pipeline': { intents: [{ type: 'title', icon: 'T', value: 'Data Engineer' }, { type: 'skill', icon: 'S', value: 'ML pipeline' }], clarification: { question: 'What is the primary focus:', options: ['Building infrastructure', 'Optimizing performance', 'Both'] }, workspace: { title: 'ML data infrastructure engineering', subtitle: 'Entry lens: Job title + Skills', need: 'You need a senior data engineer with expertise in ML pipelines, capable of designing and maintaining data infrastructure that supports machine learning workloads at scale.' } }, 'I need to reduce our contractor spend by 20%': { intents: [{ type: 'outcome', icon: 'O', value: 'Reduce contractor spend by 20%' }, { type: 'problem', icon: 'P', value: 'No visibility into rates' }], clarification: { question: 'Which approach aligns with your priority:', options: ['Rate optimization', 'Headcount reduction', 'Process efficiency'] }, workspace: { title: 'Contractor spend optimization program', subtitle: 'Entry lens: Outcome-led + Problem', need: 'You need to achieve a 20% reduction in contractor spend through rate benchmarking, vendor consolidation, and improved visibility into your contractor portfolio performance.' } }, 'Python, AWS, Kubernetes skills for DevOps': { intents: [{ type: 'skill', icon: 'S', value: 'Python, AWS, Kubernetes' }, { type: 'title', icon: 'T', value: 'DevOps' }], clarification: { question: 'Is this skill set for:', options: ['Hands-on engineering', 'Architecture & design', 'Team leadership'] }, workspace: { title: 'DevOps engineering with cloud-native skills', subtitle: 'Entry lens: Skills + Job title', need: 'You need a DevOps professional with hands-on experience in Python, AWS, and Kubernetes to build and maintain cloud-native infrastructure and CI/CD pipelines.' } }, 'Transform our customer onboarding process': { intents: [{ type: 'outcome', icon: 'O', value: 'Transform customer onboarding' }, { type: 'jtbd', icon: 'J', value: 'Process transformation' }], clarification: { question: 'What is your primary constraint:', options: ['Speed', 'Cost', 'Quality', 'Risk'] }, workspace: { title: 'Customer onboarding transformation', subtitle: 'Entry lens: Outcome + Job-to-be-done', need: 'You need to redesign the customer onboarding experience to reduce early churn and improve NPS scores.' } } };
    function setExample(t, p) { document.getElementById('inputTask').value = t; document.getElementById('inputProblem').value = p || ''; }
    function submitQuery() { const q = document.getElementById('inputTask').value.trim(), p = document.getElementById('inputProblem').value.trim(); if (!q) return; let i = exampleInterpretations[q] || { intents: [{ type: 'jtbd', icon: 'J', value: q.substring(0, 50) }], clarification: { question: 'To better understand your needs:', options: ['Short-term project', 'Ongoing capability', 'Strategic initiative'] }, workspace: { title: q.substring(0, 60), subtitle: 'Entry lens: Job-to-be-done', need: 'Based on your request, we have identified potential roles, skills, and delivery options.' } }; if (p && !i.intents.find(x => x.type === 'problem')) i.intents.push({ type: 'problem', icon: 'P', value: p.substring(0, 50) + '...' }); showInterpretingScreen(i); }
    function getIntentLabel(t) { return { title: 'Job title', skill: 'Skills', jtbd: 'Job-to-be-done', outcome: 'Outcome', problem: 'Problem statement' }[t] || t; }
    function showInterpretingScreen(i) { switchScreen('interpreting'); document.getElementById('detectedItems').innerHTML = i.intents.map(x => '<div class="detected-item"><div class="detected-icon '+x.type+'">'+x.icon+'</div><div class="detected-text"><div class="detected-type">'+getIntentLabel(x.type)+'</div><div class="detected-value">'+x.value+'</div></div></div>').join(''); document.getElementById('clarificationQuestion').textContent = i.clarification.question; document.getElementById('clarificationOptions').innerHTML = i.clarification.options.map(o => '<button class="clarification-option" onclick="selectClarification(this,\''+o+'\')">'+o+'</button>').join(''); window.currentInterpretation = i; }
    function selectClarification(btn, v) { document.querySelectorAll('.clarification-option').forEach(b => b.classList.remove('selected')); btn.classList.add('selected'); setTimeout(() => showWorkspaceScreen(), 500); }
    function showWorkspaceScreen() { const i = window.currentInterpretation; document.getElementById('workspaceTitle').textContent = i.workspace.title; document.getElementById('workspaceSubtitle').textContent = i.workspace.subtitle; document.getElementById('interpretedNeed').textContent = i.workspace.need; switchScreen('workspace'); setTimeout(() => renderCandlestickChart(), 100); }
    function switchScreen(id) { document.querySelectorAll('.screen').forEach(s => s.classList.remove('active')); document.getElementById(id + 'Screen').classList.add('active'); currentScreen = id; window.scrollTo(0, 0); }
    function resetToEntry() { document.getElementById('inputTask').value = ''; document.getElementById('inputProblem').value = ''; switchScreen('entry'); }
    function openDeepDive() { deepDiveStep = 0; deepDiveAnswers = {}; renderDeepDiveQuestion(); switchScreen('deepDive'); }
    function renderDeepDiveQuestion() { const q = deepDiveQuestions[deepDiveStep]; document.getElementById('deepDiveQuestion').innerHTML = '<div class="question-number">Question '+(deepDiveStep+1)+' of '+deepDiveQuestions.length+'</div><div class="question-text">'+q.question+'</div><div class="question-options">'+q.options.map(o => '<button class="question-option" onclick="selectDeepDiveOption(this,\''+q.id+'\',\''+o+'\')">'+o+'</button>').join('')+'</div>'; document.querySelectorAll('.progress-step').forEach((s, i) => { s.classList.remove('active', 'completed'); if (i < deepDiveStep) s.classList.add('completed'); if (i === deepDiveStep) s.classList.add('active'); }); document.getElementById('deepDiveNextBtn').disabled = !deepDiveAnswers[q.id]; }
    function selectDeepDiveOption(btn, qid, v) { document.querySelectorAll('.question-option').forEach(b => b.classList.remove('selected')); btn.classList.add('selected'); deepDiveAnswers[qid] = v; document.getElementById('deepDiveNextBtn').disabled = false; }
    function deepDiveNext() { if (deepDiveStep < deepDiveQuestions.length - 1) { deepDiveStep++; renderDeepDiveQuestion(); } else { switchScreen('workspace'); setTimeout(() => renderCandlestickChart(), 100); } }
    function deepDiveBack() { if (deepDiveStep > 0) { deepDiveStep--; renderDeepDiveQuestion(); } else { switchScreen('workspace'); setTimeout(() => renderCandlestickChart(), 100); } }
    function openMCPModal() { document.getElementById('mcpModal').classList.add('active'); }
    function closeMCPModal() { document.getElementById('mcpModal').classList.remove('active'); }
    document.getElementById('mcpModal').addEventListener('click', e => { if (e.target.id === 'mcpModal') closeMCPModal(); });
    document.querySelectorAll('.panel-toggle-btn').forEach(btn => { btn.addEventListener('click', () => { btn.parentElement.querySelectorAll('.panel-toggle-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); }); });
    document.getElementById('year').textContent = new Date().getFullYear();
    document.getElementById('inputTask').addEventListener('keypress', e => { if (e.key === 'Enter') submitQuery(); });
    window.addEventListener('resize', () => { if (currentScreen === 'workspace') renderCandlestickChart(); });
  </script>
</body>
</html>
